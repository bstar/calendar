/**
 * Defensive CSS for Calendar Widget
 * 
 * This file contains defensive styles to protect the calendar widget from external style interference.
 * These styles ensure the calendar maintains consistent appearance regardless of the host application.
 * 
 * Benefits:
 * - Protects against CSS inheritance issues
 * - Ensures proper layout and component positioning 
 * - Maintains font sizes and text styling
 * - Preserves proper z-index stacking for tooltips and portals
 * 
 * Import this file in any project where you use the calendar widget.
 */

/* Main wrapper protection */
.cla-calendar-wrapper,
.cla-calendar-portal {
  isolation: isolate !important;
  position: relative !important;
  display: inline-block !important;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important;
  line-height: 1.5 !important;
  box-sizing: border-box !important;
  max-width: 100% !important;
}

/* When calendar is open, ensure high z-index */
.cla-calendar-wrapper[data-open="true"] {
  z-index: 2147483647 !important;
}

/* Apply box-sizing to all child elements */
.cla-calendar-wrapper *,
.cla-calendar-portal * {
  box-sizing: border-box !important;
}

/* Calendar portal for popup styles */
.cla-calendar-portal {
  position: fixed !important;
  z-index: 2147483647 !important;
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
}

/* Tooltip container and styles */
.tooltip {
  position: fixed !important;
  background-color: #1a1a1a !important;
  color: #ffffff !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.35) !important;
  border-radius: 3px !important;
  z-index: 2147483647 !important;
  font-size: 13px !important;
  max-width: 300px !important;
  padding: 3px 6px !important;
  pointer-events: none !important;
  border: none !important;
  margin-top: 5px !important;
  opacity: 1 !important;
}

/* Reset text properties on calendar */
.cla-calendar,
.cla-calendar * {
  text-align: initial !important;
  text-transform: none !important;
  letter-spacing: normal !important;
  text-decoration: none !important;
  text-shadow: none !important;
}

/* Grid protection */
.cla-calendar [style*="display: grid"] {
  display: grid !important;
}

/* Restricted date pattern */
.restricted-date-pattern {
  background-image: repeating-linear-gradient(
    45deg,
    rgba(150, 150, 150, 0.25) 0px,
    rgba(150, 150, 150, 0.25) 2px,
    rgba(255, 255, 255, 0.7) 2px,
    rgba(255, 255, 255, 0.7) 6px
  ) !important;
  background-size: 8.5px 8.5px !important;
}

/* Form controls - general styles except for .cla-form-control font size */
.cla-calendar-wrapper input:not(.cla-form-control),
.cla-calendar-portal input:not(.cla-form-control) {
  line-height: inherit !important;
  background-color: #fff !important;
}

/* Set only font-family and background for form-control, font-size will be set separately */
.cla-form-control {
  line-height: inherit !important;
  background-color: #fff !important;
}

/* Main calendar input field - with higher specificity to override the general rule */
html body .cla-calendar-wrapper .cla-form-control,
html body .cla-form-control {
  width: 200px !important;
  font-size: 0.8em;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}

/* Custom input style class for user-defined styling with highest specificity */
html body .cla-calendar-wrapper .cla-input-custom,
html body .cla-input-custom {
  /* Base properties that can be overridden by user styles */
  /* These are here to ensure the input field has some defaults */
  width: 200px !important;
  padding: 8px 12px !important;
  border: 1px solid #ced4da !important;
  border-radius: 4px !important;
  font-size: 0.8rem !important;
  color: #333333 !important;
  background-color: #ffffff !important;
  box-shadow: none !important;
  cursor: pointer !important;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}

/* Calendar header with bulletproof styling */
html body .cla-calendar .cla-header,
html .cla-header[class],
.cla-calendar-root .cla-header {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 12px 16px !important;
  background-color: white !important;
  width: 100% !important;
  margin: 0 !important;
  box-sizing: border-box !important;
  min-height: 56px !important;
  position: relative !important;
  flex-wrap: nowrap !important;
  white-space: nowrap !important;
  overflow: visible !important;
}

/* Ultra-hardened chevron navigation buttons */
html body .cla-calendar .cla-button-nav,
html .cla-button-nav[class],
.cla-calendar-root .cla-button-nav {
  width: 36px !important;
  height: 36px !important;
  min-width: 36px !important; /* Ensure minimum width */
  min-height: 36px !important; /* Ensure minimum height */
  max-width: 36px !important; /* Enforce maximum width */
  max-height: 36px !important; /* Enforce maximum height */
  flex: 0 0 36px !important; /* Prevent growing/shrinking */
  padding: 0 !important; /* Remove padding completely */
  margin: 0 !important; /* Remove margin completely */
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  background: none !important; /* Reset to transparent background */
  border: none !important; /* No border */
  border-radius: 4px !important;
  cursor: pointer !important;
  transition: background-color 0.2s ease !important;
  position: relative !important;
  z-index: 5 !important; /* Ensure above other content */
  box-sizing: border-box !important;
}

/* Add spacing to title to prevent button overlap */
html body .cla-calendar .cla-header-title,
html .cla-header-title[class],
.cla-calendar-root .cla-header-title {
  margin: 0 8px !important;
  padding: 0 4px !important;
  flex: 1 1 auto !important;
  text-align: center !important;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  font-weight: 500 !important;
  font-size: 16px !important;
  line-height: 1.5 !important;
  color: #333 !important;
  position: relative !important;
  z-index: 1 !important;
}

/* Bulletproof chevron icon styling */
html body .cla-calendar .cla-chevron,
html .cla-chevron[class],
.cla-calendar-root .cla-chevron {
  display: block !important;
  width: 10px !important;
  height: 10px !important;
  min-width: 10px !important;
  min-height: 10px !important;
  position: relative !important;
  color: #333 !important; /* Base color */
  box-sizing: border-box !important;
  flex: 0 0 auto !important;
  margin: 0 !important;
  padding: 0 !important;
}

html body .cla-calendar .cla-button-nav:hover,
html .cla-button-nav[class]:hover,
.cla-calendar-root .cla-button-nav:hover {
  background-color: #f5f5f5 !important; /* Match secondary button default color */
}

html body .cla-calendar .cla-button-nav:hover .cla-chevron,
html .cla-button-nav[class]:hover .cla-chevron,
.cla-calendar-root .cla-button-nav:hover .cla-chevron {
  color: #666 !important; /* Lighter gray on hover */
}

html body .cla-calendar .cla-chevron::before,
html .cla-chevron[class]::before,
.cla-calendar-root .cla-chevron::before {
  content: '' !important;
  position: absolute !important;
  width: 8px !important;
  height: 8px !important;
  border-style: solid !important;
  border-width: 2px 2px 0 0 !important;
  border-color: currentColor !important; /* Uses the color from parent */
  top: 50% !important;
  left: 50% !important;
  margin: 0 !important;
  padding: 0 !important;
  box-sizing: border-box !important;
}

html body .cla-calendar .cla-chevron-left::before,
html .cla-chevron-left[class]::before,
.cla-calendar-root .cla-chevron-left::before {
  transform: translate(-25%, -50%) rotate(-135deg) !important;
}

html body .cla-calendar .cla-chevron-right::before,
html .cla-chevron-right[class]::before,
.cla-calendar-root .cla-chevron-right::before {
  transform: translate(-75%, -50%) rotate(45deg) !important;
}

/* Date input section fixes - with maximum specificity and !important */
html body .cla-calendar .date-input-section,
html body .cla-calendar .cla-input-container {
  display: flex !important;
  flex-wrap: nowrap !important; /* Prevent wrapping */
  flex-direction: row !important; /* Force horizontal layout */
  padding: 16px !important;
  gap: 8px !important; /* Reduced gap between inputs */
  border-bottom: 1px solid #e0e0e0 !important;
  width: 100% !important;
  background-color: #f8f9fa !important;
  box-sizing: border-box !important;
  align-items: center !important;
  justify-content: space-between !important;
  min-height: 80px !important; /* Ensure min height for the section */
  position: relative !important;
  z-index: 1 !important; /* Ensure proper stacking context */
  isolation: isolate !important;
}

/* Date input wrapper fixes - with maximum specificity */
html body .cla-calendar .cla-input-wrapper,
html body .cla-calendar .date-input-container {
  flex: 1 1 0 !important; /* Equal width with min-width override below */
  min-width: 0 !important; /* Allow shrinking below content size */
  max-width: 48% !important; /* Prevent taking more than half the space */
  position: relative !important;
  margin: 0 !important;
  isolation: isolate !important;
  white-space: nowrap !important; /* Prevent text from wrapping */
  overflow: hidden !important; /* Hide overflow */
  display: block !important;
  z-index: 2 !important;
}

/* Date input styling */
.cla-calendar .date-input {
  width: 100% !important; 
  min-width: 0 !important;
  max-width: 100% !important;
  padding: 8px 10px !important; /* Slightly reduced side padding */
  border-radius: 4px !important;
  background-color: white !important;
  color: #333 !important;
  transition: border-color 0.15s ease !important;
  cursor: text !important;
  border: 1px solid #ccc !important;
  margin: 0 !important;
  box-sizing: border-box !important;
  font-family: inherit !important;
  font-size: 14px !important;
  line-height: 1.5 !important;
  text-align: left !important; /* Left align text */
  -webkit-appearance: none !important;
  appearance: none !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
  flex-shrink: 1 !important;
  height: 38px !important; /* Fix height to prevent resizing */
  display: block !important; /* Ensure block display */
  position: relative !important;
}

/* Date input indicator position */
.cla-calendar .date-input-indicator {
  position: absolute !important;
  right: 8px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  z-index: 2 !important;
  pointer-events: none !important;
}

/* Input container additional styles */
.cla-calendar .cla-input-container {
  display: flex !important;
  flex-direction: row !important;
  flex-wrap: nowrap !important;
  width: 100% !important;
  padding: 16px !important;
  gap: 8px !important; /* Reduced gap between inputs */
  margin: 0 !important;
  background-color: #f8f9fa !important;
  border-bottom: 1px solid #e0e0e0 !important;
  box-sizing: border-box !important;
}

/* Force single-mode to respect width constraints */
.cla-calendar .cla-input-container.single .cla-input-wrapper {
  flex: 1 1 auto !important;
  width: auto !important;
}

/* Handle single vs range mode input section differently */
.cla-calendar .cla-input-container.single .date-input-container {
  /* No max-width needed */
}

/* Add a new rule specifically for the date range separator to prevent it from disappearing */
.cla-calendar .date-range-separator {
  flex: 0 0 auto !important;
  padding: 0 5px !important;
  white-space: nowrap !important;
  font-weight: normal !important;
  color: #666 !important;
}

/* Handle single vs range mode input section differently */
.cla-calendar .date-input-section.single .date-input-container {
  flex: 1 1 100% !important;
  max-width: 100% !important;
}

/* Add strong defensive wrapper for date inputs */
.cla-date-inputs-wrapper {
  width: 100% !important;
  box-sizing: border-box !important;
  display: flex !important;
  flex-direction: column !important;
  margin: 0 !important;
  padding: 0 !important;
  position: relative !important;
  flex-wrap: nowrap !important;
  min-width: 280px !important; /* Ensure some minimum width for small screens */
  background-color: #f8f9fa !important;
}

/* Improve mobile support with responsive tweaks */
@media (max-width: 500px) {
  .cla-calendar .cla-input-container {
    padding: 10px !important; /* Reduce padding on small screens */
    flex-direction: column !important; /* Stack inputs on very small screens */
    gap: 8px !important;
    align-items: stretch !important;
  }
  
  .cla-calendar .cla-input-wrapper,
  .cla-calendar .date-input-container {
    max-width: 100% !important; /* Full width on small screens */
    margin-bottom: 5px !important;
  }
  
  .cla-calendar .date-input {
    font-size: 13px !important;
    padding: 8px !important;
  }
  
  /* Special case for range mode on small screens */
  .cla-calendar .cla-input-container.range {
    min-height: 120px !important; /* More space for stacked inputs */
  }
} 